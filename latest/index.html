<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.8">
<meta name="author" content="Andrey Antukh, &lt;niwi@niwi.nz&gt;">
<title>buddy-core - Cryptographic Api for Clojure</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock pre.nowrap,.literalblock pre.nowrap pre,.listingblock pre.nowrap,.listingblock pre.nowrap pre{white-space:pre;word-wrap:normal}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #dddddf}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt,.quoteblock .quoteblock{margin:0 0 1.25em;padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<style>
.listingblock .pygments .hll { background-color: #ffffcc }
.listingblock .pygments, .listingblock .pygments code { background: #f0f0f0; }
.listingblock .pygments .tok-c { color: #60a0b0; font-style: italic } /* Comment */
.listingblock .pygments .tok-err { border: 1px solid #FF0000 } /* Error */
.listingblock .pygments .tok-k { color: #007020; font-weight: bold } /* Keyword */
.listingblock .pygments .tok-o { color: #666666 } /* Operator */
.listingblock .pygments .tok-ch { color: #60a0b0; font-style: italic } /* Comment.Hashbang */
.listingblock .pygments .tok-cm { color: #60a0b0; font-style: italic } /* Comment.Multiline */
.listingblock .pygments .tok-cp { color: #007020 } /* Comment.Preproc */
.listingblock .pygments .tok-cpf { color: #60a0b0; font-style: italic } /* Comment.PreprocFile */
.listingblock .pygments .tok-c1 { color: #60a0b0; font-style: italic } /* Comment.Single */
.listingblock .pygments .tok-cs { color: #60a0b0; background-color: #fff0f0 } /* Comment.Special */
.listingblock .pygments .tok-gd { color: #A00000 } /* Generic.Deleted */
.listingblock .pygments .tok-ge { font-style: italic } /* Generic.Emph */
.listingblock .pygments .tok-gr { color: #FF0000 } /* Generic.Error */
.listingblock .pygments .tok-gh { color: #000080; font-weight: bold } /* Generic.Heading */
.listingblock .pygments .tok-gi { color: #00A000 } /* Generic.Inserted */
.listingblock .pygments .tok-go { color: #888888 } /* Generic.Output */
.listingblock .pygments .tok-gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.listingblock .pygments .tok-gs { font-weight: bold } /* Generic.Strong */
.listingblock .pygments .tok-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.listingblock .pygments .tok-gt { color: #0044DD } /* Generic.Traceback */
.listingblock .pygments .tok-kc { color: #007020; font-weight: bold } /* Keyword.Constant */
.listingblock .pygments .tok-kd { color: #007020; font-weight: bold } /* Keyword.Declaration */
.listingblock .pygments .tok-kn { color: #007020; font-weight: bold } /* Keyword.Namespace */
.listingblock .pygments .tok-kp { color: #007020 } /* Keyword.Pseudo */
.listingblock .pygments .tok-kr { color: #007020; font-weight: bold } /* Keyword.Reserved */
.listingblock .pygments .tok-kt { color: #902000 } /* Keyword.Type */
.listingblock .pygments .tok-m { color: #40a070 } /* Literal.Number */
.listingblock .pygments .tok-s { color: #4070a0 } /* Literal.String */
.listingblock .pygments .tok-na { color: #4070a0 } /* Name.Attribute */
.listingblock .pygments .tok-nb { color: #007020 } /* Name.Builtin */
.listingblock .pygments .tok-nc { color: #0e84b5; font-weight: bold } /* Name.Class */
.listingblock .pygments .tok-no { color: #60add5 } /* Name.Constant */
.listingblock .pygments .tok-nd { color: #555555; font-weight: bold } /* Name.Decorator */
.listingblock .pygments .tok-ni { color: #d55537; font-weight: bold } /* Name.Entity */
.listingblock .pygments .tok-ne { color: #007020 } /* Name.Exception */
.listingblock .pygments .tok-nf { color: #06287e } /* Name.Function */
.listingblock .pygments .tok-nl { color: #002070; font-weight: bold } /* Name.Label */
.listingblock .pygments .tok-nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.listingblock .pygments .tok-nt { color: #062873; font-weight: bold } /* Name.Tag */
.listingblock .pygments .tok-nv { color: #bb60d5 } /* Name.Variable */
.listingblock .pygments .tok-ow { color: #007020; font-weight: bold } /* Operator.Word */
.listingblock .pygments .tok-w { color: #bbbbbb } /* Text.Whitespace */
.listingblock .pygments .tok-mb { color: #40a070 } /* Literal.Number.Bin */
.listingblock .pygments .tok-mf { color: #40a070 } /* Literal.Number.Float */
.listingblock .pygments .tok-mh { color: #40a070 } /* Literal.Number.Hex */
.listingblock .pygments .tok-mi { color: #40a070 } /* Literal.Number.Integer */
.listingblock .pygments .tok-mo { color: #40a070 } /* Literal.Number.Oct */
.listingblock .pygments .tok-sa { color: #4070a0 } /* Literal.String.Affix */
.listingblock .pygments .tok-sb { color: #4070a0 } /* Literal.String.Backtick */
.listingblock .pygments .tok-sc { color: #4070a0 } /* Literal.String.Char */
.listingblock .pygments .tok-dl { color: #4070a0 } /* Literal.String.Delimiter */
.listingblock .pygments .tok-sd { color: #4070a0; font-style: italic } /* Literal.String.Doc */
.listingblock .pygments .tok-s2 { color: #4070a0 } /* Literal.String.Double */
.listingblock .pygments .tok-se { color: #4070a0; font-weight: bold } /* Literal.String.Escape */
.listingblock .pygments .tok-sh { color: #4070a0 } /* Literal.String.Heredoc */
.listingblock .pygments .tok-si { color: #70a0d0; font-style: italic } /* Literal.String.Interpol */
.listingblock .pygments .tok-sx { color: #c65d09 } /* Literal.String.Other */
.listingblock .pygments .tok-sr { color: #235388 } /* Literal.String.Regex */
.listingblock .pygments .tok-s1 { color: #4070a0 } /* Literal.String.Single */
.listingblock .pygments .tok-ss { color: #517918 } /* Literal.String.Symbol */
.listingblock .pygments .tok-bp { color: #007020 } /* Name.Builtin.Pseudo */
.listingblock .pygments .tok-fm { color: #06287e } /* Name.Function.Magic */
.listingblock .pygments .tok-vc { color: #bb60d5 } /* Name.Variable.Class */
.listingblock .pygments .tok-vg { color: #bb60d5 } /* Name.Variable.Global */
.listingblock .pygments .tok-vi { color: #bb60d5 } /* Name.Variable.Instance */
.listingblock .pygments .tok-vm { color: #bb60d5 } /* Name.Variable.Magic */
.listingblock .pygments .tok-il { color: #40a070 } /* Literal.Number.Integer.Long */
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>buddy-core - Cryptographic Api for Clojure</h1>
<div class="details">
<span id="author" class="author">Andrey Antukh, &lt;niwi@niwi.nz&gt;</span><br>
<span id="revdate">1.7.1</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#introduction">Introduction</a>
<ul class="sectlevel2">
<li><a href="#project-maturity">Project Maturity</a></li>
<li><a href="#install">Install</a></li>
</ul>
</li>
<li><a href="#hash-algorithms-digest">Hash algorithms (digest)</a>
<ul class="sectlevel2">
<li><a href="#basic-usage">Basic usage</a></li>
<li><a href="#advanced-usage">Advanced usage</a></li>
</ul>
</li>
<li><a href="#mac-algorithms">Mac algorithms</a>
<ul class="sectlevel2">
<li><a href="#hmac">HMac</a></li>
<li><a href="#poly1305">Poly1305</a></li>
<li><a href="#advanced-usage-2">Advanced Usage</a></li>
</ul>
</li>
<li><a href="#keys">Keys</a>
<ul class="sectlevel2">
<li><a href="#reading-pem-formatted-keys">Reading PEM formatted keys</a></li>
<li><a href="#jwk">Json Web Key (JWK)</a></li>
</ul>
</li>
<li><a href="#digital-signatures">Digital Signatures</a></li>
<li><a href="#key-derivation-functions-kdf">Key Derivation Functions (KDF)</a></li>
<li><a href="#ciphers">Ciphers</a>
<ul class="sectlevel2">
<li><a href="#block-ciphers">Block Ciphers</a></li>
<li><a href="#stream-ciphers">Stream Ciphers</a></li>
<li><a href="#high-level-encryption-schemes">High level encryption schemes</a></li>
</ul>
</li>
<li><a href="#paddings">Paddings</a></li>
<li><a href="#nonces-and-salts">Nonces and Salts</a></li>
<li><a href="#codecs-bytes">Codecs &amp; Bytes</a></li>
<li><a href="#x-509-certificates">X.509 Certificates</a></li>
<li><a href="#faq">FAQ</a>
<ul class="sectlevel2">
<li><a href="#buddy-has-own-cryptographic-algorithms-implementations">Buddy has own cryptographic algorithms implementations?</a></li>
<li><a href="#buddy-will-support-pgp">Buddy will support pgp?</a></li>
<li><a href="#unexpected-exceptions-when-application-is-run-from-uberjar">Unexpected exceptions when application is run from uberjar?</a></li>
</ul>
</li>
<li><a href="#developers-guide">Developers Guide</a>
<ul class="sectlevel2">
<li><a href="#contributing">Contributing</a></li>
<li><a href="#philosophy">Philosophy</a></li>
<li><a href="#source-code">Source Code</a></li>
<li><a href="#run-tests">Run tests</a></li>
<li><a href="#license">License</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="introduction"><a class="link" href="#introduction">Introduction</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Buddy <strong>core</strong> module is dedicated to cryptographic api.</p>
</div>
<div class="paragraph">
<p>Including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>cryptographic hash algorithms (digest)</p>
</li>
<li>
<p>key derivation algorithms (kdf)</p>
</li>
<li>
<p>digital signatures</p>
</li>
<li>
<p>message authentication (mac)</p>
</li>
<li>
<p>block ciphers</p>
</li>
<li>
<p>stream ciphers</p>
</li>
<li>
<p>padding schemes</p>
</li>
<li>
<p>nonces and salts</p>
</li>
<li>
<p>X.509 certificates</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="project-maturity"><a class="link" href="#project-maturity">Project Maturity</a></h3>
<div class="paragraph">
<p>Since <em>buddy-core</em> is a young project there can be some API breakage.</p>
</div>
</div>
<div class="sect2">
<h3 id="install"><a class="link" href="#install">Install</a></h3>
<div class="paragraph">
<p>The simplest way to use <em>buddy-core</em> in a clojure project, is by including it in the
dependency vector on your <strong><em>project.clj</em></strong> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-p">[</span><span class="tok-nv">buddy/buddy-core</span> <span class="tok-s">&quot;1.7.1&quot;</span><span class="tok-p">]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Or deps.edn:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-nv">buddy/buddy-core</span> <span class="tok-p">{</span><span class="tok-ss">:mvn/version</span> <span class="tok-s">&quot;1.7.1&quot;</span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>And is tested under JDK&gt;=8.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="hash-algorithms-digest"><a class="link" href="#hash-algorithms-digest">Hash algorithms (digest)</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>All hash algorithms are located in the <code>buddy.core.hash</code> namespace.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Available hash algorithms</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Hash algorithm name</th>
<th class="tableblock halign-left valign-top">Digest size</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SHA1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">160</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SHA2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">256, 384, 512</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SHA3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">256, 384, 512</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MD5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tiger</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">192</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Blake2b</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">512</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Skein</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">256, 512, 1024, arbitrary size</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whirlpool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">512</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RIPEMD128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RIPEMD160</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">160</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RIPEMD256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">256</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RIPEMD320</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">320</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="basic-usage"><a class="link" href="#basic-usage">Basic usage</a></h3>
<div class="listingblock">
<div class="title">Import namespace example:</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.hash</span> <span class="tok-ss">:as</span> <span class="tok-nv">hash</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.codecs</span> <span class="tok-ss">:refer</span> <span class="tok-ss">:all</span><span class="tok-p">])</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Usage examples:</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-p">(</span><span class="tok-nf">hash/sha256</span> <span class="tok-s">&quot;foo bar&quot;</span><span class="tok-p">)</span>
<span class="tok-c1">;; -&gt; #&lt;byte[] [B@162a657e&gt;</span>

<span class="tok-p">(</span><span class="tok-nb">-&gt; </span><span class="tok-p">(</span><span class="tok-nf">hash/sha256</span> <span class="tok-s">&quot;foo bar&quot;</span><span class="tok-p">)</span>
    <span class="tok-p">(</span><span class="tok-nf">bytes-&gt;hex</span><span class="tok-p">))</span>
<span class="tok-c1">;; -&gt; &quot;fbc1a9f858ea9e177916964bd88c3d37b91a1e84412765e29950777f265c4b75&quot;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="advanced-usage"><a class="link" href="#advanced-usage">Advanced usage</a></h3>
<div class="paragraph">
<p>Hash functions are implemented using protocols and can be extended
to other types. The default implementations come with support
for file-like objects (<strong>File</strong>, <strong>URL</strong>, URI* and <strong>InputStream</strong>).</p>
</div>
<div class="listingblock">
<div class="title">Make hash of file example:</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-c1">;; Additional import for easy open files</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">clojure.java.io</span> <span class="tok-ss">:as</span> <span class="tok-nv">io</span><span class="tok-p">])</span>

<span class="tok-p">(</span><span class="tok-nb">-&gt; </span><span class="tok-p">(</span><span class="tok-nf">hash/sha256</span> <span class="tok-p">(</span><span class="tok-nf">io/input-stream</span> <span class="tok-s">&quot;/tmp/some-file&quot;</span><span class="tok-p">))</span>
    <span class="tok-p">(</span><span class="tok-nf">bytes-&gt;hex</span><span class="tok-p">))</span>
<span class="tok-c1">;; -&gt; &quot;bba878639499c8449f69efbfc699413eebfaf41d4b7a7faa560bfaf7e93a43dd&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can extend it for your own types using the
<strong>buddy.core.hash/IDigest</strong> protocol:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-p">(</span><span class="tok-kd">defprotocol </span><span class="tok-nv">Digest</span>
  <span class="tok-p">(</span><span class="tok-nf">-digest</span> <span class="tok-p">[</span><span class="tok-nv">data</span> <span class="tok-nv">engine</span><span class="tok-p">]))</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Functions like <strong>sha256</strong> are aliases for the more generic
function <strong>digest</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mac-algorithms"><a class="link" href="#mac-algorithms">Mac algorithms</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Buddy comes with three mac implementations: <strong>hmac</strong>, <strong>shmac</strong> and <strong>poly1305</strong>; and
all them are located under <code>buddy.core.mac</code> namespace.</p>
</div>
<div class="sect2">
<h3 id="hmac"><a class="link" href="#hmac">HMac</a></h3>
<div class="paragraph">
<p>Is a specific construction for calculating a message authentication code (MAC)
involving a cryptographic hash function in combination with a secret cryptographic
key.</p>
</div>
<div class="paragraph">
<p>Any cryptographic hash function, such as MD5 or SHA-1, may be used in the
calculation of an HMAC; the resulting MAC algorithm is termed HMAC-MD5 or
HMAC-SHA1 accordingly. The cryptographic strength of the HMAC depends upon
the cryptographic strength of the underlying hash function, the size of its
hash output, and on the size and quality of the key.</p>
</div>
<div class="listingblock">
<div class="title">Example generate a hmac from plain string using sha256 digest</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-c1">;; Import required namespaces</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.mac</span> <span class="tok-ss">:as</span> <span class="tok-nv">mac</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.codecs</span> <span class="tok-ss">:as</span> <span class="tok-nv">codecs</span><span class="tok-p">])</span>

<span class="tok-c1">;; Generate sha256 hmac over string</span>
<span class="tok-p">(</span><span class="tok-nb">-&gt; </span><span class="tok-p">(</span><span class="tok-nf">mac/hash</span> <span class="tok-s">&quot;foo bar&quot;</span> <span class="tok-p">{</span><span class="tok-ss">:key</span> <span class="tok-s">&quot;mysecretkey&quot;</span> <span class="tok-ss">:alg</span> <span class="tok-ss">:hmac+sha256</span><span class="tok-p">})</span>
    <span class="tok-p">(</span><span class="tok-nf">codecs/bytes-&gt;hex</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; &quot;61849448bdbb67b39d609471eead667e65b0d1b9e01b1c3bf7aa56b83e9c8083&quot;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example verifying a hmac</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-p">(</span><span class="tok-nf">mac/verify</span> <span class="tok-s">&quot;foo bar&quot;</span> <span class="tok-p">(</span><span class="tok-nf">codecs/hex-&gt;bytes</span> <span class="tok-s">&quot;61849448bdbb67b...&quot;</span><span class="tok-p">)</span>
            <span class="tok-p">{</span><span class="tok-ss">:key</span> <span class="tok-s">&quot;mysecretkey&quot;</span> <span class="tok-ss">:alg</span> <span class="tok-ss">:hmac+sha256</span><span class="tok-p">})</span>
<span class="tok-c1">;; =&gt; true</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The key parameter can be any type that implements the <strong>ByteArray</strong> protocol
defined in the <code>buddy.core.codecs</code> namespace. It comes with default implementations
for <code>byte[]</code> and <code>java.lang.String</code> and <code>nil</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="poly1305"><a class="link" href="#poly1305">Poly1305</a></h3>
<div class="paragraph">
<p>Poly1305 is a cryptographic message authentication code (MAC) written by Daniel
J. Bernstein. It can be used to verify the data integrity and the authenticity of
a message.</p>
</div>
<div class="paragraph">
<p>The security of Poly1305 is very close to the block cipher algorithm. As a result,
the only way for an attacker to break Poly1305 is to break the cipher.</p>
</div>
<div class="paragraph">
<p>Poly1305 offers cipher replaceability. If anything goes wrong with one, it can
be substituted by another with identical security guarantees.</p>
</div>
<div class="paragraph">
<p>Unlike <strong>hmac</strong>, it requires an initialization vector (IV). An IV is like a salt.
It should be generated using a strong random number generator for security
guarantees. Also, the IV should be of the same length as the chosen cipher block
size.</p>
</div>
<div class="listingblock">
<div class="title">Example using poly1305 mac algorithm for generate mac from string</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.codecs</span> <span class="tok-ss">:as</span> <span class="tok-nv">codecs</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.mac</span> <span class="tok-ss">:as</span> <span class="tok-nv">mac</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.nonce</span> <span class="tok-ss">:as</span> <span class="tok-nv">nonce</span><span class="tok-p">])</span>

<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nb">key </span><span class="tok-p">(</span><span class="tok-nf">nonce/random-bytes</span> <span class="tok-mi">32</span><span class="tok-p">))</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">iv</span> <span class="tok-p">(</span><span class="tok-nf">nonce/random-bytes</span> <span class="tok-mi">32</span><span class="tok-p">))</span>

<span class="tok-p">(</span><span class="tok-nb">-&gt; </span><span class="tok-p">(</span><span class="tok-nf">mac/hash</span> <span class="tok-s">&quot;some-data&quot;</span> <span class="tok-p">{</span><span class="tok-ss">:key</span> <span class="tok-nb">key </span><span class="tok-ss">:iv</span> <span class="tok-nv">iv</span> <span class="tok-ss">:alg</span> <span class="tok-ss">:poly1305+aes</span><span class="tok-p">})</span>
    <span class="tok-p">(</span><span class="tok-nf">codecs/bytes-&gt;hex</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; &quot;1976b1c490c306e7304a59dfacee4207&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The default specification talks about AES as default block cipher but the algorith
in fact can work other block ciphers without any problem. So you can use <code>serpent</code>
and twofish among the default aes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-p">(</span><span class="tok-nb">-&gt; </span><span class="tok-p">(</span><span class="tok-nf">mac/hash</span> <span class="tok-s">&quot;some-data&quot;</span> <span class="tok-p">{</span><span class="tok-ss">:key</span> <span class="tok-nb">key </span><span class="tok-ss">:iv</span> <span class="tok-nv">iv</span> <span class="tok-ss">:alg</span> <span class="tok-ss">:poly1305+twofish</span><span class="tok-p">})</span>
    <span class="tok-p">(</span><span class="tok-nf">codecs/bytes-&gt;hex</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; &quot;6e7304a59dfacee42071976b1c490c30&quot;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="advanced-usage-2"><a class="link" href="#advanced-usage-2">Advanced Usage</a></h3>
<div class="sect3">
<h4 id="generate-mac-for-file-like-objects"><a class="link" href="#generate-mac-for-file-like-objects">Generate mac for file like objects</a></h4>
<div class="paragraph">
<p>Like with hash functions, you can use String, byte[], <strong>File</strong>, <strong>URL</strong>, <strong>URI</strong> and
<strong>InputStream</strong> as input value for mac functions:</p>
</div>
<div class="listingblock">
<div class="title">Example generating hmac from input stream</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">clojure.java.io</span> <span class="tok-ss">:as</span> <span class="tok-nv">io</span><span class="tok-p">])</span>

<span class="tok-c1">;; Generate hmac for file</span>
<span class="tok-p">(</span><span class="tok-nb">-&gt; </span><span class="tok-p">(</span><span class="tok-nf">io/input-stream</span> <span class="tok-s">&quot;/tmp/somefile&quot;</span><span class="tok-p">)</span>
    <span class="tok-p">(</span><span class="tok-nf">mac/hash</span> <span class="tok-p">{</span><span class="tok-ss">:key</span> <span class="tok-s">&quot;mysecretkey&quot;</span> <span class="tok-ss">:alg</span> <span class="tok-ss">:hmac-sha256</span><span class="tok-p">})</span>
    <span class="tok-p">(</span><span class="tok-nf">codecs/bytes-&gt;hex</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; &quot;4cb793e600848da205323800...&quot;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="low-level-api"><a class="link" href="#low-level-api">Low-Level Api</a></h4>
<div class="paragraph">
<p>Behind the scenes of the high level api, a low level api is already defined
with protocols and you can use it for your purposes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-p">(</span><span class="tok-k">let </span><span class="tok-p">[</span><span class="tok-nv">engine</span> <span class="tok-p">(</span><span class="tok-nf">mac/-engine</span> <span class="tok-p">{</span><span class="tok-ss">:alg</span> <span class="tok-ss">:hnac+sha256</span><span class="tok-p">})]</span>
  <span class="tok-p">(</span><span class="tok-nf">mac/-update</span> <span class="tok-nv">engine</span> <span class="tok-p">(</span><span class="tok-nf">codecs/str-&gt;bytes</span> <span class="tok-s">&quot;hello&quot;</span><span class="tok-p">)</span> <span class="tok-mi">0</span> <span class="tok-mi">5</span><span class="tok-p">)</span>
  <span class="tok-p">(</span><span class="tok-nf">codecs/bytes-&gt;hex</span> <span class="tok-p">(</span><span class="tok-nf">mac/-end</span> <span class="tok-nv">engine</span><span class="tok-p">)))</span>
<span class="tok-c1">;; &quot;924c4b82a56c0115eb9...&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This also applies to the rest of mac implementations found in <strong>buddy-core</strong> library.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="keys"><a class="link" href="#keys">Keys</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="reading-pem-formatted-keys"><a class="link" href="#reading-pem-formatted-keys">Reading PEM formatted keys</a></h3>
<div class="paragraph">
<p>Before explaining digital signatures, you need to read public/private
keypairs and convert them to usable objects. Buddy has limited support
for reading:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>RSA keypair</p>
</li>
<li>
<p>ECDSA keypair</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="rsa-keypair"><a class="link" href="#rsa-keypair">RSA Keypair</a></h4>
<div class="paragraph">
<p>An RSA keypair is obviously used for RSA encryption/decryption, but it
is also used for making digital signatures with RSA-derived
algorithms.</p>
</div>
<div class="listingblock">
<div class="title">Read keys</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.keys</span> <span class="tok-ss">:as</span> <span class="tok-nv">keys</span><span class="tok-p">])</span>

<span class="tok-c1">;; The last parameter is optional and is only mandatory</span>
<span class="tok-c1">;; if a private key is encrypted.</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">privkey</span> <span class="tok-p">(</span><span class="tok-nf">keys/private-key</span> <span class="tok-s">&quot;test/_files/privkey.3des.rsa.pem&quot;</span> <span class="tok-s">&quot;secret&quot;</span><span class="tok-p">)</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">pubkey</span> <span class="tok-p">(</span><span class="tok-nf">keys/public-key</span> <span class="tok-s">&quot;test/_files/pubkey.3des.rsa.pem&quot;</span><span class="tok-p">))</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Generate a RSA Keypair using openssl.</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span><span class="tok-c1"># Generate AES-256 encrypted private key</span>
openssl genrsa -aes256 -out privkey.pem <span class="tok-m">2048</span>

<span class="tok-c1"># Generate public key from previously created private key.</span>
openssl rsa -pubout -in privkey.pem -out pubkey.pem</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ecdsa-keypair"><a class="link" href="#ecdsa-keypair">ECDSA Keypair</a></h4>
<div class="paragraph">
<p>Like RSA keypairs, ECDSA is also used for making digital signatures
and can be read like in the RSA examples.</p>
</div>
<div class="listingblock">
<div class="title">Read keys.</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.keys</span> <span class="tok-ss">:as</span> <span class="tok-nv">keys</span><span class="tok-p">])</span>

<span class="tok-c1">;; The last parameter is optional and is only mandatory</span>
<span class="tok-c1">;; if a private key is encrypted.</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">privkey</span> <span class="tok-p">(</span><span class="tok-nf">keys/private-key</span> <span class="tok-s">&quot;test/_files/privkey.ecdsa.pem&quot;</span> <span class="tok-s">&quot;secret&quot;</span><span class="tok-p">)</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">pubkey</span> <span class="tok-p">(</span><span class="tok-nf">keys/public-key</span> <span class="tok-s">&quot;test/_files/pubkey.ecdsa.pem&quot;</span><span class="tok-p">))</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Generate a ECDSA Keypair using openssl.</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span><span class="tok-c1"># Generate a params file</span>
openssl ecparam -name prime256v1 -out ecparams.pem

<span class="tok-c1"># Generate a private key from params file</span>
openssl ecparam -in ecparams.pem -genkey -noout -out ecprivkey.pem

<span class="tok-c1"># Generate a public key from private key</span>
openssl ec -in ecprivkey.pem -pubout -out ecpubkey.pem</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="jwk"><a class="link" href="#jwk">Json Web Key (JWK)</a></h3>
<div class="paragraph">
<p>A JSON Web Key (JWK) is a JavaScript Object Notation (JSON) data
structure that represents a cryptographic key of different types.</p>
</div>
<div class="paragraph">
<p><em>buddy-core</em> provides functions for reading and saving JCA keys in JWK format</p>
</div>
<div class="paragraph">
<p>Currently supported JWK key types are</p>
</div>
<div class="ulist">
<ul>
<li>
<p>RSA key pairs (No RSA-CRT support yet)</p>
</li>
<li>
<p>OKP key pairs (Ed25519)</p>
</li>
<li>
<p>EC key pairs (P-256, P-384, P-521 curves)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example of JWS signing for Ed25519 keys</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.keys</span> <span class="tok-ss">:as</span> <span class="tok-nv">keys</span><span class="tok-p">])</span>

<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">edkey</span> <span class="tok-p">{</span><span class="tok-ss">:kty</span> <span class="tok-s">&quot;OKP&quot;</span>,
            <span class="tok-ss">:crv</span> <span class="tok-s">&quot;Ed25519&quot;</span>,
            <span class="tok-ss">:d</span> <span class="tok-s">&quot;nWGxne_9WmC6hEr0kuwsxERJxWl7MmkZcDusAxyuf2A&quot;</span>,
            <span class="tok-ss">:x</span> <span class="tok-s">&quot;11qYAYKxCrfVS_7TyWQHOg7hcvPapiMlrwIaaPcHURo&quot;</span><span class="tok-p">})</span>

<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">privkey</span> <span class="tok-p">(</span><span class="tok-nf">keys/jwk-&gt;private-key</span> <span class="tok-nv">edkey</span><span class="tok-p">))</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also convert from PEM to JWK like this</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.keys</span> <span class="tok-ss">:as</span> <span class="tok-nv">keys</span><span class="tok-p">])</span>

<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">prv</span> <span class="tok-p">(</span><span class="tok-nf">keys/private-key</span> <span class="tok-s">&quot;private.pem&quot;</span><span class="tok-p">))</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">pub</span> <span class="tok-p">(</span><span class="tok-nf">keys/public-key</span> <span class="tok-s">&quot;public.pem&quot;</span><span class="tok-p">))</span>

<span class="tok-c1">;; JWK requires both public and private keys for export</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">jwk</span> <span class="tok-p">(</span><span class="tok-nf">keys/jwk</span> <span class="tok-nv">prv</span> <span class="tok-nv">pub</span><span class="tok-p">))</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">jwk-pub</span> <span class="tok-p">(</span><span class="tok-nf">keys/public-key-&gt;jwk</span> <span class="tok-nv">pub</span><span class="tok-p">))</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a id="ed25519-generation"></a>You can generate and save keys in JWK format like this</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.keys</span> <span class="tok-ss">:as</span> <span class="tok-nv">keys</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nb">import </span><span class="tok-ss">&#39;java.security.KeyPairGenerator</span><span class="tok-p">)</span>
<span class="tok-p">(</span><span class="tok-nb">import </span><span class="tok-ss">&#39;java.security.SecureRandom</span><span class="tok-p">)</span>

<span class="tok-p">(</span><span class="tok-kd">defn </span><span class="tok-nv">generate-keypair-ed25519</span>
  <span class="tok-p">[]</span>
  <span class="tok-p">(</span><span class="tok-k">let </span><span class="tok-p">[</span><span class="tok-nv">kg</span> <span class="tok-p">(</span><span class="tok-nf">KeyPairGenerator/getInstance</span> <span class="tok-s">&quot;EdDSA&quot;</span> <span class="tok-s">&quot;EdDSA&quot;</span><span class="tok-p">)]</span>
    <span class="tok-p">(</span><span class="tok-nf">.initialize</span> <span class="tok-nv">kg</span>
                 <span class="tok-mi">256</span>
                 <span class="tok-c1">;; JDK8 only, use getInstance on JDK7 (make sure it&#39;s true random source)</span>
                 <span class="tok-p">(</span><span class="tok-nf">SecureRandom/getInstanceStrong</span><span class="tok-p">))</span>
    <span class="tok-p">(</span><span class="tok-nf">.genKeyPair</span> <span class="tok-nv">kg</span><span class="tok-p">)))</span>

<span class="tok-p">(</span><span class="tok-k">let </span><span class="tok-p">[</span><span class="tok-nv">pair</span> <span class="tok-p">(</span><span class="tok-nf">generate-keypair-ed25519</span><span class="tok-p">)]</span>
  <span class="tok-p">(</span><span class="tok-nf">keys/jwk</span> <span class="tok-p">(</span><span class="tok-nf">.getPrivate</span> <span class="tok-nv">pair</span><span class="tok-p">)</span> <span class="tok-p">(</span><span class="tok-nf">.getPublic</span> <span class="tok-nv">pair</span><span class="tok-p">)))</span>

<span class="tok-c1">;; =&gt;</span>
<span class="tok-c1">;; {:kty &quot;OKP&quot;,</span>
<span class="tok-c1">;;  :crv &quot;Ed25519&quot;,</span>
<span class="tok-c1">;;  :d &quot;5q3yhCdSDMj9Za9jJE0vhfExlTV8JeSe6XnfblAFkPY&quot;,</span>
<span class="tok-c1">;;  :x &quot;JbbhB16SaghHiGHx3FutVMfVTgu9-SCtZGfZyoDZSbQ&quot;}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also calculate JWK thumbprint using <code>jwk-thumbprint</code> function</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.keys</span> <span class="tok-ss">:as</span> <span class="tok-nv">keys</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.codecs</span> <span class="tok-ss">:as</span> <span class="tok-nv">codecs</span><span class="tok-p">])</span>

<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">edkey</span> <span class="tok-p">{</span><span class="tok-ss">:kty</span> <span class="tok-s">&quot;OKP&quot;</span>,
            <span class="tok-ss">:crv</span> <span class="tok-s">&quot;Ed25519&quot;</span>,
            <span class="tok-ss">:d</span> <span class="tok-s">&quot;nWGxne_9WmC6hEr0kuwsxERJxWl7MmkZcDusAxyuf2A&quot;</span>,
            <span class="tok-ss">:x</span> <span class="tok-s">&quot;11qYAYKxCrfVS_7TyWQHOg7hcvPapiMlrwIaaPcHURo&quot;</span><span class="tok-p">})</span>

<span class="tok-p">(</span><span class="tok-nb">-&gt; </span><span class="tok-p">(</span><span class="tok-nf">keys/jwk-thumbprint</span> <span class="tok-nv">edkey</span><span class="tok-p">)</span>
    <span class="tok-p">(</span><span class="tok-nf">codecs/bytes-&gt;hex</span><span class="tok-p">))</span>

<span class="tok-c1">;; =&gt; &quot;90facafea9b1556698540f70c0117a22ea37bd5cf3ed3c47093c1707282b4b89&quot;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="digital-signatures"><a class="link" href="#digital-signatures">Digital Signatures</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Digital Signature algorithms has similar purposes that MAC but comes
with some tradeoffs such as them provides additional security feature
(Non-repudiation) with cost in the performance. You can read a great
explanation about the differences with MAC
<a href="http://crypto.stackexchange.com/a/5647">here</a>.</p>
</div>
<div class="paragraph">
<p><strong>buddy-core</strong> comes with support for:
<a href="https://en.wikipedia.org/wiki/PKCS_1">rsassa-pss</a>,
<a href="https://en.wikipedia.org/wiki/PKCS_1">rsassa-pkcs</a> and
<a href="https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm">ecdsa</a>.</p>
</div>
<div class="listingblock">
<div class="title">Example signing string using rsassa-pss+sha256</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.keys</span> <span class="tok-ss">:as</span> <span class="tok-nv">keys</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.dsa</span> <span class="tok-ss">:as</span> <span class="tok-nv">dsa</span><span class="tok-p">])</span>

<span class="tok-c1">;; Read private key</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">privkey</span> <span class="tok-p">(</span><span class="tok-nf">keys/private-key</span> <span class="tok-s">&quot;test/_files/privkey.3des.rsa.pem&quot;</span> <span class="tok-s">&quot;secret&quot;</span><span class="tok-p">))</span>

<span class="tok-c1">;; Make signature</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">signature</span> <span class="tok-p">(</span><span class="tok-nf">dsa/sign</span> <span class="tok-s">&quot;foo&quot;</span> <span class="tok-p">{</span><span class="tok-ss">:key</span> <span class="tok-nv">privkey</span> <span class="tok-ss">:alg</span> <span class="tok-ss">:rsassa-pss+sha256</span><span class="tok-p">}))</span>

<span class="tok-c1">;; Now signature contains a byte[] with signature of &quot;foo&quot; string</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example verifying signature</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-c1">;; Read public key</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">pubkey</span> <span class="tok-p">(</span><span class="tok-nf">keys/public-key</span> <span class="tok-s">&quot;test/_files/pubkey.3des.rsa.pem&quot;</span><span class="tok-p">))</span>

<span class="tok-c1">;; Make verification</span>
<span class="tok-p">(</span><span class="tok-nf">dsa/verify</span> <span class="tok-s">&quot;foo&quot;</span> <span class="tok-nv">signature</span> <span class="tok-p">{</span><span class="tok-ss">:key</span> <span class="tok-nv">pubkey</span> <span class="tok-ss">:alg</span> <span class="tok-ss">:rsassa-pss+sha256</span><span class="tok-p">})</span>
<span class="tok-c1">;; =&gt; true</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is a table with complete list of supported algorithms and its variants:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Algorithm name</th>
<th class="tableblock halign-left valign-top"><code>:alg</code> keyword value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RSASSA-PSS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:rsassa-pss+sha256</code>, <code>:rsassa-pss+sha384</code>, <code>:rsassa-pss+sha512</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RSASSA-PKCS 1.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:rsassa-pkcs15+sha256</code>, <code>:rsassa-pkcs15+sha384</code>, <code>:rsassa-pkcs15+sha512</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ECDSA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:ecdsa+sha256</code>, <code>:ecdsa+sha384</code>, <code>:ecdsa+sha512</code></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<strong>ECDSA</strong> algorithm requires EC type of asymentric key pair.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="key-derivation-functions-kdf"><a class="link" href="#key-derivation-functions-kdf">Key Derivation Functions (KDF)</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Key derivation functions are often used in conjunction with non-secret parameters
to derive one or more keys from a common secret value.</p>
</div>
<div class="paragraph">
<p><strong>buddy</strong> commes with several of them:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Supported key derivation functions.</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 50%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top"><code>:alg</code> value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HKDF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:hkdf+sha256</code>, <code>:hkdf+sha384</code>, <code>:hkdf+sha512</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HMAC-based Extract-and-Expand Key Derivation Function</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">KDF1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:kdf1+sha256</code>, <code>:kdf1+sha384</code>, <code>:kdf1+sha512</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">KDF v1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">KDF2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:kdf2+sha256</code>, <code>:kdf2+sha384</code>, <code>:kdf2+sha512</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">KDF v2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CMKDF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:cmkdf+sha256</code>, <code>:cmkdf+sha384</code>, <code>:cmkdf+sha512</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Counter-Mode key derivation function (as defined in NIST SP800-108)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FMKDF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:fmkdf+sha256</code>, <code>:fmkdf+sha384</code>, <code>:fmkdf+sha512</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Feedback-Mode key derivation function (as defined in NIST SP800-108)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DPIMKDF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:dpimkdf+sha256</code>, <code>:dpimkdf+sha384</code>, <code>:dpimkdf+sha512</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Double-Pipeline Iteration Mode key derivation function (as defined in NIST SP800-108)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PBKDF2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:pbkdf2+sha256</code>, <code>:pbkdf2+sha384</code>, <code>:pbkdf2+sha512</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password-Based Key Derivation Function 2 (a.k.a. <code>RSA PKCS #5 v2.0</code>, also published in RFC 2898)</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example using KDF with HKDF key derivation function</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.codecs</span> <span class="tok-ss">:as</span> <span class="tok-nv">codecs</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.kdf</span> <span class="tok-ss">:as</span> <span class="tok-nv">kdf</span><span class="tok-p">])</span>

<span class="tok-c1">;; Using hkdf derivation functions. It requires a</span>
<span class="tok-c1">;; key, salt and optionally info field that can</span>
<span class="tok-c1">;; contain any random data.</span>

<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">hkdf</span> <span class="tok-p">(</span><span class="tok-nf">kdf/engine</span> <span class="tok-p">{</span><span class="tok-ss">:alg</span> <span class="tok-ss">:hkdf+sha256</span>
                       <span class="tok-ss">:key</span> <span class="tok-s">&quot;mysecret&quot;</span>
                       <span class="tok-ss">:salt</span> <span class="tok-s">&quot;mysalt&quot;</span><span class="tok-p">}))</span>

<span class="tok-p">(</span><span class="tok-nb">-&gt; </span><span class="tok-p">(</span><span class="tok-nf">kdf/get-bytes</span> <span class="tok-nv">hkdf</span> <span class="tok-mi">8</span><span class="tok-p">)</span>
    <span class="tok-p">(</span><span class="tok-nf">codecs/bytes-&gt;hex</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; &quot;0faba553152fce4f&quot;</span>


<span class="tok-c1">;; Or using different digest algorithm:</span>

<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">hkdf</span> <span class="tok-p">(</span><span class="tok-nf">kdf/engine</span> <span class="tok-p">{</span><span class="tok-ss">:alg</span> <span class="tok-ss">:hkdf</span>
                       <span class="tok-ss">:digest</span> <span class="tok-ss">:blake2b-512</span>
                       <span class="tok-ss">:key</span> <span class="tok-s">&quot;test&quot;</span>
                       <span class="tok-ss">:salt</span> <span class="tok-s">&quot;test&quot;</span><span class="tok-p">}))</span>

<span class="tok-p">(</span><span class="tok-nb">-&gt; </span><span class="tok-p">(</span><span class="tok-nf">kdf/get-bytes</span> <span class="tok-nv">hkdf</span> <span class="tok-mi">8</span><span class="tok-p">)</span>
    <span class="tok-p">(</span><span class="tok-nf">codecs/bytes-&gt;hex</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; &quot;9d22728d54e549a6&quot;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example using PBKDF2 with sha256</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">pbkdf2</span> <span class="tok-p">(</span><span class="tok-nf">kdf/engine</span> <span class="tok-p">{</span><span class="tok-ss">:key</span> <span class="tok-s">&quot;my password&quot;</span>
                         <span class="tok-ss">:salt</span> <span class="tok-p">(</span><span class="tok-nf">nonce/random-bytes</span> <span class="tok-mi">8</span><span class="tok-p">)</span>
                         <span class="tok-ss">:alg</span> <span class="tok-ss">:pbkdf2</span>
                         <span class="tok-ss">:digest</span> <span class="tok-ss">:sha256</span>
                         <span class="tok-ss">:iterations</span> <span class="tok-mi">1</span><span class="tok-p">}))</span>

<span class="tok-p">(</span><span class="tok-nb">-&gt; </span><span class="tok-p">(</span><span class="tok-nf">kdf/get-bytes</span> <span class="tok-nv">pbkdf2</span> <span class="tok-mi">8</span><span class="tok-p">)</span>
    <span class="tok-p">(</span><span class="tok-nf">codecs/bytes-&gt;hex</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; &quot;26606ebf3a4bb4b3&quot;</span></code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>PBKDF2 works slightly different to the rest of KDF implementations. You should pass
the number of iterations explicltly and <code>get-bytes</code> always returns the same value in
contrast to the others where <code>get-bytes</code> works as consumer of infinite stream.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-c1">;; Note the same output for multiple requests:</span>

<span class="tok-p">(</span><span class="tok-nb">-&gt; </span><span class="tok-p">(</span><span class="tok-nf">kdf/get-bytes</span> <span class="tok-nv">pbkdf2</span> <span class="tok-mi">8</span><span class="tok-p">)</span>
    <span class="tok-p">(</span><span class="tok-nf">codecs/bytes-&gt;hex</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; &quot;26606ebf3a4bb4b3&quot;</span>

<span class="tok-p">(</span><span class="tok-nb">-&gt; </span><span class="tok-p">(</span><span class="tok-nf">kdf/get-bytes</span> <span class="tok-nv">pbkdf2</span> <span class="tok-mi">8</span><span class="tok-p">)</span>
    <span class="tok-p">(</span><span class="tok-nf">codecs/bytes-&gt;hex</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; &quot;26606ebf3a4bb4b3&quot;</span>

<span class="tok-c1">;; Note that each request returns the next</span>
<span class="tok-c1">;; bytes of the stream:</span>

<span class="tok-p">(</span><span class="tok-nb">-&gt; </span><span class="tok-p">(</span><span class="tok-nf">kdf/get-bytes</span> <span class="tok-nv">hkdf</span> <span class="tok-mi">8</span><span class="tok-p">)</span>
    <span class="tok-p">(</span><span class="tok-nf">codecs/bytes-&gt;hex</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; &quot;d42edcfc40c860ce&quot;</span>

<span class="tok-p">(</span><span class="tok-nb">-&gt; </span><span class="tok-p">(</span><span class="tok-nf">kdf/get-bytes</span> <span class="tok-nv">hkdf</span> <span class="tok-mi">8</span><span class="tok-p">)</span>
    <span class="tok-p">(</span><span class="tok-nf">codecs/bytes-&gt;hex</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; &quot;353ce2240159c094&quot;</span></code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>This is a <strong>low-level</strong> kdf primitive and if you want a password hasher, please use
<code>buddy-hashers</code> module instead of this.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ciphers"><a class="link" href="#ciphers">Ciphers</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Ciphers support in buddy is available on <code>buddy.core.crypto</code> namespace.</p>
</div>
<div class="sect2">
<h3 id="block-ciphers"><a class="link" href="#block-ciphers">Block Ciphers</a></h3>
<div class="paragraph">
<p>In cryptography, a block cipher is a deterministic algorithm operating on
fixed-length groups of bits, called blocks, with an unvarying transformation
that is specified by a symmetric key.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. This is a list of currently supported block ciphers in buddy</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Algorithm name</th>
<th class="tableblock halign-left valign-top">Keywords</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:aes</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Twofish</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:twofish</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Blowfish</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:blowfish</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Additionally, for good security, is mandatory to combine a block cipher with
some cipher mode of operation.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. This is a list of currently supported of cipher mode of operation</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Algorithm name</th>
<th class="tableblock halign-left valign-top">Keywords</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SIC (CTR)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:ctr</code>, <code>:sic</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:cbc</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OFB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:ofb</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GCM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:gcm</code></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
currently buddy comes with limited number of ciphers and modes, but in
near future more many more options should be added.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Example encrypt</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.crypto</span> <span class="tok-ss">:as</span> <span class="tok-nv">crypto</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.nonce</span> <span class="tok-ss">:as</span> <span class="tok-nv">nonce</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.codecs</span> <span class="tok-ss">:as</span> <span class="tok-nv">codecs</span><span class="tok-p">])</span>

<span class="tok-p">(</span><span class="tok-k">let </span><span class="tok-p">[</span><span class="tok-nv">eng</span>   <span class="tok-p">(</span><span class="tok-nf">crypto/block-cipher</span> <span class="tok-ss">:twofish</span> <span class="tok-ss">:cbc</span><span class="tok-p">)</span>
      <span class="tok-nv">iv16</span>  <span class="tok-p">(</span><span class="tok-nf">nonce/random-nonce</span> <span class="tok-mi">16</span><span class="tok-p">)</span>
      <span class="tok-nv">key32</span> <span class="tok-p">(</span><span class="tok-nf">nonce/random-nonce</span> <span class="tok-mi">32</span><span class="tok-p">)</span>
      <span class="tok-nv">data</span>  <span class="tok-p">(</span><span class="tok-nf">codecs/hex-&gt;bytes</span> <span class="tok-s">&quot;000000000000000000000000000000AA&quot;</span><span class="tok-p">)]</span>
  <span class="tok-p">(</span><span class="tok-nf">crypto/init!</span> <span class="tok-nv">eng</span> <span class="tok-p">{</span><span class="tok-ss">:key</span> <span class="tok-nv">key32</span> <span class="tok-ss">:iv</span> <span class="tok-nv">iv16</span> <span class="tok-ss">:op</span> <span class="tok-ss">:encrypt</span><span class="tok-p">})</span>
  <span class="tok-p">(</span><span class="tok-nf">crypto/process-block!</span> <span class="tok-nv">eng</span> <span class="tok-nv">data</span><span class="tok-p">))</span>

<span class="tok-c1">;; =&gt; #&lt;byte[] [B@efadff9&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>AEAD mode of operations also exposes additional function for caluclate the total
size of the output including the authentication tag: <code>output-size</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="stream-ciphers"><a class="link" href="#stream-ciphers">Stream Ciphers</a></h3>
<div class="paragraph">
<p>Stream ciphers differ from block ciphers, in that they works with arbitrary
length input and do not require any additional mode of operation.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. This is a list of currently supported of stream ciphers in buddy</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Algorithm name</th>
<th class="tableblock halign-left valign-top">Keywords</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ChaCha</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:chacha</code></p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Example encrypt</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.crypto</span> <span class="tok-ss">:as</span> <span class="tok-nv">crypto</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.codecs</span> <span class="tok-ss">:as</span> <span class="tok-nv">codecs</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.nonce</span> <span class="tok-ss">:as</span> <span class="tok-nv">nonce</span><span class="tok-p">])</span>

<span class="tok-p">(</span><span class="tok-k">let </span><span class="tok-p">[</span><span class="tok-nv">eng</span>   <span class="tok-p">(</span><span class="tok-nf">crypto/stream-cipher</span> <span class="tok-ss">:chacha</span><span class="tok-p">)</span>
      <span class="tok-nv">iv8</span>   <span class="tok-p">(</span><span class="tok-nf">nonce/random-nonce</span> <span class="tok-mi">8</span><span class="tok-p">)</span>
      <span class="tok-nv">key32</span> <span class="tok-p">(</span><span class="tok-nf">nonce/random-nonce</span> <span class="tok-mi">32</span><span class="tok-p">)</span>
      <span class="tok-nv">data</span>  <span class="tok-p">(</span><span class="tok-nf">codecs/hex-&gt;bytes</span> <span class="tok-s">&quot;0011&quot;</span><span class="tok-p">)]</span>
  <span class="tok-p">(</span><span class="tok-nf">crypto/init!</span> <span class="tok-nv">eng</span> <span class="tok-p">{</span><span class="tok-ss">:key</span> <span class="tok-nv">key32</span> <span class="tok-ss">:iv</span> <span class="tok-nv">iv8</span> <span class="tok-ss">:op</span> <span class="tok-ss">:encrypt</span><span class="tok-p">})</span>
  <span class="tok-p">(</span><span class="tok-nf">crypto/process-bytes!</span> <span class="tok-nv">eng</span> <span class="tok-nv">data</span><span class="tok-p">))</span>

<span class="tok-c1">;; =&gt; #&lt;byte[] [B@efadff9&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
the iv and key size depends estrictly on cipher engine, in this case, chacha
engine requires 8 bytes iv.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
for decrypt, only change <code>:op</code> value to <code>:decrypt</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can call <code>crypto/initialize!</code> any times as you want, it simply reinitializes
the engine.</p>
</div>
</div>
<div class="sect2">
<h3 id="high-level-encryption-schemes"><a class="link" href="#high-level-encryption-schemes">High level encryption schemes</a></h3>
<div class="paragraph">
<p>Since version 0.6.0, <em>buddy-core</em> comes with high level crypto interface that allows user
encrypt arbitrary length data using one of the well established encryption schemes.</p>
</div>
<div class="paragraph">
<p>The api consists in two simple functions. Let see an example of how to encrypt arbitrary
length text and decrypt it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.crypto</span> <span class="tok-ss">:as</span> <span class="tok-nv">crypto</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.codecs</span> <span class="tok-ss">:as</span> <span class="tok-nv">codecs</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.nonce</span> <span class="tok-ss">:as</span> <span class="tok-nv">nonce</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.hash</span> <span class="tok-ss">:as</span> <span class="tok-nv">hash</span><span class="tok-p">])</span>

<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">original-text</span>
  <span class="tok-p">(</span><span class="tok-nf">codecs/to-bytes</span> <span class="tok-s">&quot;Hello World.&quot;</span><span class="tok-p">))</span>

<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">iv</span> <span class="tok-p">(</span><span class="tok-nf">nonce/random-bytes</span> <span class="tok-mi">16</span><span class="tok-p">))</span>   <span class="tok-c1">;; 16 bytes random iv</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nb">key </span><span class="tok-p">(</span><span class="tok-nf">hash/sha256</span> <span class="tok-s">&quot;mysecret&quot;</span><span class="tok-p">))</span> <span class="tok-c1">;; 32 bytes key</span>

<span class="tok-c1">;; Encrypt the original-text content using previously</span>
<span class="tok-c1">;; declared iv and key.</span>
<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">encrypted</span> <span class="tok-p">(</span><span class="tok-nf">crypto/encrypt</span> <span class="tok-nv">original-text</span> <span class="tok-nb">key </span><span class="tok-nv">iv</span>
                               <span class="tok-p">{</span><span class="tok-ss">:algorithm</span> <span class="tok-ss">:aes128-cbc-hmac-sha256</span><span class="tok-p">}))</span>

<span class="tok-c1">;; And now, decrypt it using the same parameters:</span>
<span class="tok-p">(</span><span class="tok-nb">-&gt; </span><span class="tok-p">(</span><span class="tok-nf">crypto/decrypt</span> <span class="tok-nv">encrypted</span> <span class="tok-nb">key </span><span class="tok-nv">iv</span> <span class="tok-p">{</span><span class="tok-ss">:algorithm</span> <span class="tok-ss">:aes128-cbc-hmac-sha256</span><span class="tok-p">})</span>
    <span class="tok-p">(</span><span class="tok-nf">codecs/bytes-&gt;str</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; &quot;Hello World.&quot;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is a complete list of supported encryption schemes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>:aes128-cbc-hmac-sha256</code> (default)</p>
</li>
<li>
<p><code>:aes192-cbc-hmac-sha384</code></p>
</li>
<li>
<p><code>:aes256-cbc-hmac-sha512</code></p>
</li>
<li>
<p><code>:aes128-gcm</code></p>
</li>
<li>
<p><code>:aes192-gcm</code></p>
</li>
<li>
<p><code>:aes256-gcm</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="paddings"><a class="link" href="#paddings">Paddings</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Padding schemes are often used for fill the empty bytes of byte array of data to an concrete
blocksize.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. This is a list of currently supported padding schemes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Algorithm name</th>
<th class="tableblock halign-left valign-top">Keywords</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Zero Byte</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:zerobyte</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKCS7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:pkcs7</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TBC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>:tbc</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Let see an example on how to use it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.padding</span> <span class="tok-ss">:as</span> <span class="tok-nv">padding</span><span class="tok-p">])</span>
<span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.bytes</span> <span class="tok-ss">:as</span> <span class="tok-nv">bytes</span><span class="tok-p">])</span>

<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">data</span> <span class="tok-p">(</span><span class="tok-nf">byte-array</span> <span class="tok-mi">10</span><span class="tok-p">))</span>

<span class="tok-c1">;; Fill the array with byte value 10</span>
<span class="tok-p">(</span><span class="tok-nf">bytes/fill!</span> <span class="tok-nv">data</span> <span class="tok-mi">10</span><span class="tok-p">)</span>

<span class="tok-c1">;; Add padding to the byte array with offset value: 7</span>
<span class="tok-c1">;; This is a side effect and it will mutate the data</span>
<span class="tok-c1">;; byte array.</span>

<span class="tok-p">(</span><span class="tok-nf">vec</span> <span class="tok-p">(</span><span class="tok-nf">padding/pad!</span> <span class="tok-nv">data</span> <span class="tok-mi">7</span> <span class="tok-ss">:pkcs7</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt;[10 10 10 10 10 10 10 3 3 3]</span>

<span class="tok-c1">;; Also it has the side effect free version of it, that</span>
<span class="tok-c1">;; returns a new byte array.</span>

<span class="tok-p">(</span><span class="tok-nf">vec</span> <span class="tok-p">(</span><span class="tok-nf">padding/pad</span> <span class="tok-nv">data</span> <span class="tok-mi">7</span> <span class="tok-ss">:pkcs7</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt;[10 10 10 10 10 10 10 3 3 3]</span>


<span class="tok-c1">;; Show the size of applied padding</span>
<span class="tok-p">(</span><span class="tok-nf">padding/count</span> <span class="tok-nv">data</span> <span class="tok-ss">:pkcs7</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; 3</span>

<span class="tok-c1">;; Remove the padding</span>
<span class="tok-p">(</span><span class="tok-nf">vec</span> <span class="tok-p">(</span><span class="tok-nf">padding/unpad</span> <span class="tok-nv">data</span> <span class="tok-mi">7</span> <span class="tok-ss">:pkcs7</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt;[10 10 10 10 10 10 10 0 0 0]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The default padding scheme is <code>:pkcs7</code> and that parameter can be ommited.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="nonces-and-salts"><a class="link" href="#nonces-and-salts">Nonces and Salts</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This library comes with helpers for generate random salts and cryptographically secure
nonces:</p>
</div>
<div class="listingblock">
<div class="title">Generate a cryptographically secure nonce</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.nonce</span> <span class="tok-ss">:as</span> <span class="tok-nv">nonce</span><span class="tok-p">])</span>

<span class="tok-p">(</span><span class="tok-nf">vec</span> <span class="tok-p">(</span><span class="tok-nf">nonce/random-nonce</span> <span class="tok-mi">16</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; [0 0 1 75 -114 49 -91 107 67 -124 -49 -2 -96 100 42 18]</span>

<span class="tok-p">(</span><span class="tok-nf">vec</span> <span class="tok-p">(</span><span class="tok-nf">nonce/random-nonce</span> <span class="tok-mi">16</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; [0 0 1 75 -114 49 -88 -102 92 88 111 69 46 93 1 -86]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>random-nonce</strong> function returns a byte array with minimum length of 8 bytes, because
is the size of the current time in miliseconds.</p>
</div>
<div class="listingblock">
<div class="title">Generate a cryptographically secure salt</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.nonce</span> <span class="tok-ss">:as</span> <span class="tok-nv">nonce</span><span class="tok-p">])</span>

<span class="tok-p">(</span><span class="tok-nf">vec</span> <span class="tok-p">(</span><span class="tok-nf">nonce/random-bytes</span> <span class="tok-mi">16</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt;[-50 20 -120 -38 -32 -121 -15 109 86 -99 85 -73 28 -92 -67 -64]</span>

<span class="tok-p">(</span><span class="tok-nf">vec</span> <span class="tok-p">(</span><span class="tok-nf">nonce/random-bytes</span> <span class="tok-mi">16</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; [84 -88 51 120 122 -30 78 -31 -96 -22 119 122 29 -54 -64 -73]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Like <strong>random-nonce</strong> function, <strong>random-bytes</strong> returns a byte array but it not have
the limitation of minimum 8 bytes of size.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="codecs-bytes"><a class="link" href="#codecs-bytes">Codecs &amp; Bytes</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This library comes with helpers for working with codecs (hex, base64, &#8230;&#8203;) and byte arrays.</p>
</div>
<div class="paragraph">
<p>This is a brief list of available functions:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. Available hash algorithms</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Namespace/Function</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.codecs/str&#8594;bytes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Converts a string into byte array</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.codecs/bytes&#8594;str</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Converts byte array to string using UTF8 encoding</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.codecs/bytes&#8594;hex</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Converts byte array to hexadecimal string</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.codecs/hex&#8594;bytes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Converts hexadecimal strings into byte array</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.codecs/long&#8594;bytes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get byte array representation of long</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.codecs/bytes&#8594;long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get long from byte array</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.bytes/bytes?</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Predicate for test byte arrays</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.bytes/fill!</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fill byte array with data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.bytes/slice</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create a new byte array as slice of other</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.bytes/copy</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Copy the byte array.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.bytes/equals?</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constant time equals predicate for byte arrays</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buddy.core.bytes/concat</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Concat two or more byte arrays</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="x-509-certificates"><a class="link" href="#x-509-certificates">X.509 Certificates</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Support for basic certificate handling is available in the buddy.core.certificates namespace.</p>
</div>
<div class="paragraph">
<p>You can load certificates, check date validity, and check to see if a certificate is signed
by a known public key.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="clojure"><span></span><span class="tok-p">(</span><span class="tok-nf">require</span> <span class="tok-o">&#39;</span><span class="tok-p">[</span><span class="tok-nv">buddy.core.certificates</span> <span class="tok-ss">:as</span> <span class="tok-nv">certs</span><span class="tok-p">])</span>

<span class="tok-p">(</span><span class="tok-k">def </span><span class="tok-nv">cert</span> <span class="tok-p">(</span><span class="tok-nf">certs/certificate</span> <span class="tok-s">&quot;path/to/certificate.crt&quot;</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; #object[org.bouncycastle.cert.X509CertificateHolder 0x2919034b &quot;org.bouncycastle.cert.X509CertificateHolder@1612eab1&quot;]</span>
<span class="tok-p">(</span><span class="tok-nf">certs/valid-on-date?</span> <span class="tok-nv">cert</span><span class="tok-p">)</span>
<span class="tok-c1">;; =&gt; true if today is between not-before and not-after</span>

<span class="tok-p">(</span><span class="tok-nf">certs/verify-signature</span> <span class="tok-nv">cert</span> <span class="tok-p">(</span><span class="tok-nf">certs/certificate</span> <span class="tok-s">&quot;path/to/ca.crt&quot;</span><span class="tok-p">))</span>
<span class="tok-c1">;; =&gt; true if cert is signed by public key in ca.crt</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="faq"><a class="link" href="#faq">FAQ</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="buddy-has-own-cryptographic-algorithms-implementations"><a class="link" href="#buddy-has-own-cryptographic-algorithms-implementations">Buddy has own cryptographic algorithms implementations?</a></h3>
<div class="paragraph">
<p>Mainly no, I&#8217;m not cryptography expert and for this I rely on the to
battle tested Bouncy Castle java library that&#8217;s dedicated to this
purpose.</p>
</div>
</div>
<div class="sect2">
<h3 id="buddy-will-support-pgp"><a class="link" href="#buddy-will-support-pgp">Buddy will support pgp?</a></h3>
<div class="paragraph">
<p>Surely not! Because there already exists one good
<a href="https://github.com/greglook/clj-pgp">library for that</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="unexpected-exceptions-when-application-is-run-from-uberjar"><a class="link" href="#unexpected-exceptions-when-application-is-run-from-uberjar">Unexpected exceptions when application is run from uberjar?</a></h3>
<div class="paragraph">
<p>This is known problem of BouncyCastle. This is because, some parts of buddy uses the BC provider
that BouncyCastle exposes. And any security providers for the JDK should be signed. And if you
repackage all dependencies of your application in one unique jar, it will not match the signature
of BC provider, and then, jdk will silently rejects adding it.</p>
</div>
<div class="paragraph">
<p>Take care that only very small part of buddy-core is subject to this
issue. Only the <code>buddy.core.dsa</code> and <code>buddy.core.keys</code> (partially) are
using the security provider. So if you are using it, you will need to
provide the bouncy castle dependency separatelly to your uberjar
bundle.</p>
</div>
<div class="paragraph">
<p>A common approach for this case, is just put <code>:uberjar-exclusions
[#"org/bouncycastle"]</code> on your <code>:uberjar</code> profile and then, download
the bouncycastle jars and expose them in the classpath. If you are
running your application directly from lein, you are not affected by
this issue.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="developers-guide"><a class="link" href="#developers-guide">Developers Guide</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="contributing"><a class="link" href="#contributing">Contributing</a></h3>
<div class="paragraph">
<p>Unlike Clojure and other Clojure contributed libraries <em>buddy-core</em> does not have many
restrictions for contributions. Just open an issue or pull request.</p>
</div>
</div>
<div class="sect2">
<h3 id="philosophy"><a class="link" href="#philosophy">Philosophy</a></h3>
<div class="paragraph">
<p>Five most important rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Beautiful is better than ugly.</p>
</li>
<li>
<p>Explicit is better than implicit.</p>
</li>
<li>
<p>Simple is better than complex.</p>
</li>
<li>
<p>Complex is better than complicated.</p>
</li>
<li>
<p>Readability counts.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All contributions to <em>buddy-core</em> should keep these important rules in mind.</p>
</div>
</div>
<div class="sect2">
<h3 id="source-code"><a class="link" href="#source-code">Source Code</a></h3>
<div class="paragraph">
<p><em>buddy-core</em> is open source and can be found on <a href="https://github.com/funcool/buddy-core">github</a>.</p>
</div>
<div class="paragraph">
<p>You can clone the public repository with this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span>git clone https://github.com/funcool/buddy-core</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="run-tests"><a class="link" href="#run-tests">Run tests</a></h3>
<div class="paragraph">
<p>For running tests just execute this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span>lein test-all</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="license"><a class="link" href="#license">License</a></h3>
<div class="paragraph">
<p><em>buddy-core</em> is licensed under Apache 2.0 License. You can see the complete text
of the license on the root of the repository on <code>LICENSE</code> file.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2020-09-14 23:56:05 +0200
</div>
</div>
</body>
</html>